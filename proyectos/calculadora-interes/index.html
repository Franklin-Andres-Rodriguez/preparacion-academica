<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üí° De $2.3M de P√©rdidas a C√≥digo Profesional | Bugs que Cuestan Millones</title>
<meta name="description" content="La evoluci√≥n completa: c√≥mo transformar c√≥digo naive en soluciones profesionales que habr√≠an salvado FinTechCorp">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Crimson+Pro:ital,wght@0,400;0,500;1,400&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

<style>
/* =============================================
 * DESIGN SYSTEM - Sarah Drasner's Visual Excellence
 * Following atomic design principles and modern UX patterns
 * ============================================= */

:root {
  /* Design Tokens - Systematic approach */
  --font-primary: 'Space Grotesk', system-ui, sans-serif;
  --font-body: 'Crimson Pro', Georgia, serif;
  --font-code: 'JetBrains Mono', 'Fira Code', monospace;
  
  /* Color Palette - Accessibility first */
  --color-success: #22c55e;
  --color-success-light: rgba(34, 197, 94, 0.1);
  --color-success-glow: rgba(34, 197, 94, 0.4);
  --color-danger: #ef4444;
  --color-danger-light: rgba(239, 68, 68, 0.1);
  --color-warning: #f59e0b;
  --color-warning-light: rgba(245, 158, 11, 0.1);
  --color-brand: #8b5cf6;
  --color-brand-light: rgba(139, 92, 246, 0.1);
  
  /* Dark Theme */
  --bg-primary: #0f0f0f;
  --bg-secondary: #1a1a1a;
  --bg-surface: #262626;
  --bg-surface-hover: #2d2d2d;
  --border-color: #404040;
  --text-primary: #f5f5f5;
  --text-secondary: #a3a3a3;
  --text-muted: #737373;
  
  /* Spacing System - 8pt grid */
  --space-1: 0.25rem;
  --space-2: 0.5rem;
  --space-3: 0.75rem;
  --space-4: 1rem;
  --space-5: 1.25rem;
  --space-6: 1.5rem;
  --space-8: 2rem;
  --space-10: 2.5rem;
  --space-12: 3rem;
  --space-16: 4rem;
  --space-20: 5rem;
  
  /* Typography Scale */
  --text-xs: 0.75rem;
  --text-sm: 0.875rem;
  --text-base: 1rem;
  --text-lg: 1.125rem;
  --text-xl: 1.25rem;
  --text-2xl: 1.5rem;
  --text-3xl: 1.875rem;
  --text-4xl: 2.25rem;
  
  /* Borders & Radius */
  --radius-sm: 0.375rem;
  --radius: 0.5rem;
  --radius-lg: 0.75rem;
  --radius-xl: 1rem;
  --radius-2xl: 1.5rem;
  --radius-full: 9999px;
  
  /* Shadows */
  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
  --shadow-glow: 0 0 30px var(--color-brand-light);
  
  /* Animation System */
  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --duration-slow: 350ms;
  --easing-smooth: cubic-bezier(0.4, 0, 0.2, 1);
  --easing-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

/* Base Styles - Reset + Typography */
*, *::before, *::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: var(--font-body);
  background: var(--bg-primary);
  color: var(--text-primary);
  line-height: 1.6;
  font-size: var(--text-base);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* =============================================
 * COMPONENT LIBRARY - Atomic Design System
 * ============================================= */

/* ATOMS */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  padding: var(--space-3) var(--space-6);
  border: none;
  border-radius: var(--radius-lg);
  font-family: var(--font-primary);
  font-weight: 600;
  font-size: var(--text-sm);
  text-decoration: none;
  cursor: pointer;
  transition: all var(--duration-normal) var(--easing-smooth);
  position: relative;
  overflow: hidden;
}

.btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: left var(--duration-slow) var(--easing-smooth);
}

.btn:hover::before {
  left: 100%;
}

.btn-primary {
  background: linear-gradient(135deg, var(--color-brand), var(--color-success));
  color: white;
  box-shadow: var(--shadow);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.btn-secondary {
  background: var(--bg-surface);
  color: var(--text-primary);
  border: 1px solid var(--border-color);
}

.btn-secondary:hover {
  background: var(--bg-surface-hover);
  transform: translateY(-1px);
}

.input {
  width: 100%;
  padding: var(--space-4);
  background: var(--bg-surface);
  border: 2px solid var(--border-color);
  border-radius: var(--radius-lg);
  color: var(--text-primary);
  font-family: var(--font-code);
  font-size: var(--text-base);
  transition: all var(--duration-normal) var(--easing-smooth);
  outline: none;
}

.input:focus {
  border-color: var(--color-brand);
  box-shadow: 0 0 0 3px var(--color-brand-light);
}

.input:invalid {
  border-color: var(--color-danger);
}

.card {
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-xl);
  padding: var(--space-6);
  box-shadow: var(--shadow);
  transition: all var(--duration-normal) var(--easing-smooth);
}

.card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
  border-color: var(--color-brand);
}

/* MOLECULES */
.progress-ring {
  position: relative;
  width: 120px;
  height: 120px;
}

.progress-ring-circle {
  transform: rotate(-90deg);
  transition: stroke-dashoffset var(--duration-slow) var(--easing-smooth);
}

.badge {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-full);
  font-family: var(--font-primary);
  font-size: var(--text-xs);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.badge-success {
  background: var(--color-success-light);
  color: var(--color-success);
  border: 1px solid var(--color-success);
}

.badge-danger {
  background: var(--color-danger-light);
  color: var(--color-danger);
  border: 1px solid var(--color-danger);
}

.badge-warning {
  background: var(--color-warning-light);
  color: var(--color-warning);
  border: 1px solid var(--color-warning);
}

/* ORGANISMS */
.calculator-interface {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-8);
  margin-bottom: var(--space-12);
}

.evolution-stepper {
  display: flex;
  justify-content: space-between;
  margin-bottom: var(--space-8);
  position: relative;
}

.evolution-stepper::before {
  content: '';
  position: absolute;
  top: 24px;
  left: 48px;
  right: 48px;
  height: 2px;
  background: var(--border-color);
  z-index: 0;
}

.evolution-step {
  position: relative;
  z-index: 1;
  background: var(--bg-secondary);
  border: 2px solid var(--border-color);
  border-radius: var(--radius-full);
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--text-lg);
  transition: all var(--duration-normal) var(--easing-smooth);
  cursor: pointer;
}

.evolution-step.active {
  border-color: var(--color-success);
  background: var(--color-success);
  color: white;
  box-shadow: 0 0 20px var(--color-success-glow);
}

.evolution-step.completed {
  border-color: var(--color-brand);
  background: var(--color-brand);
  color: white;
}

/* TEMPLATES */
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 var(--space-6);
}

.hero-section {
  text-align: center;
  padding: var(--space-20) 0 var(--space-16);
  position: relative;
  overflow: hidden;
}

.hero-section::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: radial-gradient(ellipse at center, var(--color-brand-light), transparent 70%);
  animation: heroGlow 4s ease-in-out infinite alternate;
}

@keyframes heroGlow {
  0% { opacity: 0.3; transform: scale(1); }
  100% { opacity: 0.6; transform: scale(1.05); }
}

.hero-title {
  font-family: var(--font-primary);
  font-size: clamp(var(--text-3xl), 5vw, var(--text-4xl));
  font-weight: 700;
  margin-bottom: var(--space-4);
  background: linear-gradient(135deg, var(--text-primary), var(--color-brand));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  position: relative;
  z-index: 1;
}

.section {
  margin-bottom: var(--space-16);
  opacity: 0;
  transform: translateY(20px);
  animation: fadeInUp var(--duration-slow) var(--easing-smooth) forwards;
}

@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* =============================================
 * COMPONENT-SPECIFIC STYLES
 * ============================================= */

.achievement-toast {
  position: fixed;
  top: var(--space-6);
  right: var(--space-6);
  background: linear-gradient(135deg, var(--color-success), var(--color-brand));
  color: white;
  padding: var(--space-4) var(--space-6);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-lg);
  z-index: 1000;
  transform: translateX(100%);
  transition: all var(--duration-normal) var(--easing-bounce);
  max-width: 320px;
  font-family: var(--font-primary);
  font-size: var(--text-sm);
  font-weight: 600;
}

.achievement-toast.show {
  transform: translateX(0);
}

.progress-sidebar {
  position: fixed;
  left: var(--space-6);
  top: 50%;
  transform: translateY(-50%);
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  border-radius: var(--radius-2xl);
  padding: var(--space-6);
  box-shadow: var(--shadow-lg);
  color: var(--bg-primary);
  min-width: 280px;
  opacity: 0;
  transform: translateY(-50%) translateX(-100%);
  transition: all var(--duration-slow) var(--easing-smooth);
  z-index: 100;
}

.progress-sidebar.visible {
  opacity: 1;
  transform: translateY(-50%) translateX(0);
}

.calculator-results {
  background: var(--bg-surface);
  border-radius: var(--radius-2xl);
  padding: var(--space-8);
  border: 1px solid var(--border-color);
  min-height: 400px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  transition: all var(--duration-normal) var(--easing-smooth);
}

.result-comparison {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-6);
  margin: var(--space-6) 0;
}

.result-panel {
  background: var(--bg-secondary);
  border-radius: var(--radius-xl);
  padding: var(--space-6);
  text-align: center;
  border: 2px solid var(--border-color);
  transition: all var(--duration-normal) var(--easing-smooth);
}

.result-panel.success {
  border-color: var(--color-success);
  background: var(--color-success-light);
}

.result-panel.danger {
  border-color: var(--color-danger);
  background: var(--color-danger-light);
}

.result-value {
  font-family: var(--font-code);
  font-size: var(--text-2xl);
  font-weight: 700;
  margin: var(--space-4) 0;
}

.code-showcase {
  background: #0d1117;
  border-radius: var(--radius-xl);
  padding: var(--space-6);
  margin: var(--space-6) 0;
  border: 1px solid var(--border-color);
  overflow-x: auto;
}

.code-showcase pre {
  font-family: var(--font-code);
  font-size: var(--text-sm);
  line-height: 1.6;
  color: #e6edf3;
  margin: 0;
}

/* Syntax highlighting */
.keyword { color: #ff7b72; }
.string { color: #a5d6ff; }
.number { color: #79c0ff; }
.comment { color: #8b949e; font-style: italic; }
.function { color: #d2a8ff; }
.variable { color: #7dd3fc; }

/* =============================================
 * RESPONSIVE DESIGN
 * ============================================= */

@media (max-width: 1024px) {
  .calculator-interface {
    grid-template-columns: 1fr;
    gap: var(--space-6);
  }
  
  .progress-sidebar {
    position: static;
    transform: none;
    opacity: 1;
    margin-bottom: var(--space-8);
  }
}

@media (max-width: 768px) {
  .container {
    padding: 0 var(--space-4);
  }
  
  .result-comparison {
    grid-template-columns: 1fr;
  }
  
  .evolution-stepper {
    flex-wrap: wrap;
    gap: var(--space-4);
  }
  
  .evolution-stepper::before {
    display: none;
  }
  
  .hero-section {
    padding: var(--space-12) 0 var(--space-8);
  }
}

/* =============================================
 * MICRO-ANIMATIONS & INTERACTIONS
 * ============================================= */

.loading-spinner {
  width: 20px;
  height: 20px;
  border: 2px solid var(--color-brand-light);
  border-top: 2px solid var(--color-brand);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.fade-in {
  animation: fadeInUp var(--duration-normal) var(--easing-smooth) forwards;
}

.scale-in {
  animation: scaleIn var(--duration-normal) var(--easing-bounce) forwards;
}

@keyframes scaleIn {
  0% { transform: scale(0.8); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

.pulse {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: .5; }
}
</style>
</head>

<body>
  <!-- Achievement Toast System -->
  <div id="achievementToast" class="achievement-toast">
    <div class="achievement-content">
      <span id="achievementIcon">üèÜ</span>
      <span id="achievementText">Achievement Unlocked!</span>
    </div>
  </div>

  <!-- Progress Sidebar -->
  <aside id="progressSidebar" class="progress-sidebar">
    <div style="font-family: var(--font-primary); font-weight: 700; font-size: var(--text-lg); margin-bottom: var(--space-4); color: var(--bg-primary);">
      üéØ Foundation Progress
    </div>
    
    <div class="progress-section" style="margin-bottom: var(--space-4);">
      <div style="font-size: var(--text-sm); font-weight: 600; margin-bottom: var(--space-2); color: var(--bg-primary);">
        Problem Understanding
      </div>
      <div class="progress-ring">
        <svg width="120" height="120">
          <circle cx="60" cy="60" r="54" stroke="rgba(0,0,0,0.1)" stroke-width="12" fill="none"/>
          <circle id="problemProgressRing" cx="60" cy="60" r="54" stroke="var(--color-success)" 
                  stroke-width="12" fill="none" class="progress-ring-circle"
                  stroke-dasharray="339.292" stroke-dashoffset="339.292"/>
        </svg>
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-weight: 700; color: var(--bg-primary);">
          <span id="problemPercentage">0%</span>
        </div>
      </div>
    </div>
    
    <div class="progress-section" style="margin-bottom: var(--space-4);">
      <div style="font-size: var(--text-sm); font-weight: 600; margin-bottom: var(--space-2); color: var(--bg-primary);">
        Active Learning
      </div>
      <div style="display: flex; gap: var(--space-2);">
        <div id="experimentationBadge" class="badge badge-success" style="opacity: 0.3;">
          üß™ <span id="experimentationCount">0</span> Tests
        </div>
        <div id="masteryBadge" class="badge badge-success" style="opacity: 0.3;">
          ‚úÖ Clean Code
        </div>
      </div>
    </div>
    
    <div id="masteryAchieved" style="background: linear-gradient(135deg, var(--color-success), var(--color-brand)); color: white; padding: var(--space-4); border-radius: var(--radius-lg); text-align: center; opacity: 0; transform: scale(0.8); transition: all var(--duration-slow) var(--easing-bounce);">
      <div style="font-size: var(--text-lg); margin-bottom: var(--space-2);">üèÜ</div>
      <div style="font-size: var(--text-sm); font-weight: 600;">Foundation Mastery Achieved!</div>
    </div>
  </aside>

  <!-- Navigation -->
  <nav style="position: fixed; top: var(--space-6); left: 50%; transform: translateX(-50%); z-index: 100;">
    <a href="../../index.html" class="btn btn-secondary">
      üè† Laboratorio Principal
    </a>
  </nav>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="container">
      <div class="badge badge-success" style="margin-bottom: var(--space-6);">
        ‚úÖ Soluci√≥n Profesional ‚Ä¢ Foundation Level
      </div>
      
      <h1 class="hero-title">
        De $2.3M de P√©rdidas a C√≥digo Profesional
      </h1>
      
      <p style="font-size: var(--text-xl); color: var(--text-secondary); margin-bottom: var(--space-8); font-style: italic;">
        La evoluci√≥n completa: c√≥mo <strong>Clean Architecture</strong> habr√≠a salvado FinTechCorp
      </p>
      
      <!-- Evolution Stepper -->
      <div class="evolution-stepper">
        <div class="evolution-step completed" data-step="naive" title="C√≥digo Naive">
          üî•
        </div>
        <div class="evolution-step completed" data-step="improved" title="Refactoring">
          üîß
        </div>
        <div class="evolution-step completed" data-step="testing" title="Testing">
          üß™
        </div>
        <div class="evolution-step active" data-step="professional" title="C√≥digo Profesional">
          ‚úÖ
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <main class="container">
    
    <!-- Interactive Calculator Section -->
    <section class="section">
      <div style="text-align: center; margin-bottom: var(--space-8);">
        <h2 style="font-family: var(--font-primary); font-size: var(--text-3xl); font-weight: 700; margin-bottom: var(--space-4);">
          üßÆ Laboratorio Interactivo
        </h2>
        <p style="color: var(--text-secondary); font-size: var(--text-lg);">
          Compara el m√©todo <strong style="color: var(--color-danger);">naive que quebr√≥ FinTechCorp</strong> 
          vs la <strong style="color: var(--color-success);">soluci√≥n profesional</strong>
        </p>
      </div>
      
      <div class="calculator-interface">
        <!-- Input Panel -->
        <div class="card">
          <h3 style="font-family: var(--font-primary); font-size: var(--text-xl); font-weight: 600; margin-bottom: var(--space-6);">
            üìä Par√°metros de Prueba
          </h3>
          
          <div style="margin-bottom: var(--space-5);">
            <label style="display: block; font-weight: 600; margin-bottom: var(--space-2); color: var(--text-secondary);">
              üí∞ Capital inicial ($)
            </label>
            <input type="number" id="principalInput" class="input" value="1000" min="1" step="100">
          </div>
          
          <div style="margin-bottom: var(--space-5);">
            <label style="display: block; font-weight: 600; margin-bottom: var(--space-2); color: var(--text-secondary);">
              üìà Tasa anual (%)
            </label>
            <input type="number" id="rateInput" class="input" value="5" min="0" max="50" step="0.25">
          </div>
          
          <div style="margin-bottom: var(--space-6);">
            <label style="display: block; font-weight: 600; margin-bottom: var(--space-2); color: var(--text-secondary);">
              ‚è∞ Tiempo (a√±os)
            </label>
            <input type="number" id="timeInput" class="input" value="5" min="0.1" max="50" step="0.1">
          </div>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-3);">
            <button id="compareBtn" class="btn btn-primary">
              üî¨ Comparar
            </button>
            <button id="stressTestBtn" class="btn btn-secondary">
              üî• Stress Test
            </button>
          </div>
        </div>
        
        <!-- Results Panel -->
        <div id="resultsPanel" class="calculator-results">
          <div style="color: var(--text-secondary);">
            <h4 style="font-family: var(--font-primary); margin-bottom: var(--space-4); color: var(--color-brand);">
              üí° Listo para Comparar
            </h4>
            <p style="margin-bottom: var(--space-4);">
              El <strong style="color: var(--color-danger);">m√©todo naive</strong> solo funciona con 5% anual<br>
              La <strong style="color: var(--color-success);">soluci√≥n profesional</strong> funciona con cualquier valor
            </p>
            <p style="font-size: var(--text-sm); color: var(--text-muted);">
              Ajusta los par√°metros y presiona "Comparar" para ver las diferencias
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Code Evolution Section -->
    <section class="section">
      <div style="text-align: center; margin-bottom: var(--space-8);">
        <h2 style="font-family: var(--font-primary); font-size: var(--text-3xl); font-weight: 700; margin-bottom: var(--space-4);">
          üîÑ Evoluci√≥n del C√≥digo
        </h2>
        <p style="color: var(--text-secondary); font-size: var(--text-lg);">
          <strong>Robert C. Martin's Clean Code</strong> + <strong>Martin Fowler's Refactoring</strong>: 
          Del desastre al c√≥digo profesional
        </p>
      </div>
      
      <!-- Code Showcase -->
      <div class="card">
        <div style="display: flex; justify-content: between; align-items: center; margin-bottom: var(--space-6);">
          <h3 style="font-family: var(--font-primary); font-size: var(--text-xl); font-weight: 600;">
            ‚úÖ Soluci√≥n Profesional (Clean Architecture)
          </h3>
          <div class="badge badge-success">C√ìDIGO PROFESIONAL</div>
        </div>
        
        <div class="code-showcase">
          <pre><code><span class="comment">// Soluci√≥n que habr√≠a salvado FinTechCorp</span>
<span class="comment">// Following SOLID principles and Clean Architecture</span>

<span class="keyword">class</span> <span class="function">CompoundInterestCalculator</span> {
    
    <span class="comment">/**
     * Calcula inter√©s compuesto usando la f√≥rmula matem√°tica correcta
     * A = P * (1 + r)^t
     * @param {number} principal - Capital inicial
     * @param {number} annualRate - Tasa anual (ej: 5 para 5%)
     * @param {number} timeInYears - Tiempo en a√±os (acepta decimales)
     * @returns {number} Monto final
     */</span>
    <span class="keyword">static</span> <span class="function">calculate</span>(<span class="variable">principal</span>, <span class="variable">annualRate</span>, <span class="variable">timeInYears</span>) {
        <span class="comment">// Validaci√≥n robusta (Kent Beck's Simple Design)</span>
        <span class="keyword">if</span> (!<span class="variable">principal</span> || <span class="variable">principal</span> <= <span class="number">0</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="function">Error</span>(<span class="string">'Principal must be greater than 0'</span>);
        }
        <span class="keyword">if</span> (<span class="variable">annualRate</span> < <span class="number">0</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="function">Error</span>(<span class="string">'Rate cannot be negative'</span>);
        }
        <span class="keyword">if</span> (<span class="variable">timeInYears</span> < <span class="number">0</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="function">Error</span>(<span class="string">'Time cannot be negative'</span>);
        }
        
        <span class="comment">// F√≥rmula matem√°tica correcta (no loops needed)</span>
        <span class="keyword">const</span> <span class="variable">rate</span> = <span class="variable">annualRate</span> / <span class="number">100</span>;
        <span class="keyword">return</span> <span class="variable">principal</span> * <span class="function">Math.pow</span>(<span class="number">1</span> + <span class="variable">rate</span>, <span class="variable">timeInYears</span>);
    }
    
    <span class="comment">// Extensibilidad: diferentes tipos de composici√≥n</span>
    <span class="keyword">static</span> <span class="function">calculateMonthlyCompounding</span>(<span class="variable">principal</span>, <span class="variable">annualRate</span>, <span class="variable">years</span>) {
        <span class="keyword">const</span> <span class="variable">monthlyRate</span> = <span class="variable">annualRate</span> / <span class="number">100</span> / <span class="number">12</span>;
        <span class="keyword">const</span> <span class="variable">totalMonths</span> = <span class="variable">years</span> * <span class="number">12</span>;
        <span class="keyword">return</span> <span class="variable">principal</span> * <span class="function">Math.pow</span>(<span class="number">1</span> + <span class="variable">monthlyRate</span>, <span class="variable">totalMonths</span>);
    }
}

<span class="comment">// USO SIMPLE Y SEGURO:</span>
<span class="comment">// CompoundInterestCalculator.calculate(1000, 5, 5.5); // 6 meses funciona!</span>
<span class="comment">// CompoundInterestCalculator.calculate(50000, 7.25, 20); // Cualquier valor!</span></code></pre>
        </div>
        
        <div style="background: var(--color-success-light); padding: var(--space-4); border-radius: var(--radius-lg); margin-top: var(--space-4); border-left: 4px solid var(--color-success);">
          <h4 style="color: var(--color-success); margin-bottom: var(--space-3); font-family: var(--font-primary);">
            ‚úÖ Principios Clean Code Aplicados
          </h4>
          <ul style="list-style: none; color: var(--text-primary);">
            <li style="margin-bottom: var(--space-2);">‚úÖ <strong>Single Responsibility</strong> - Cada m√©todo hace una cosa</li>
            <li style="margin-bottom: var(--space-2);">‚úÖ <strong>Open/Closed</strong> - Extensible sin modificar c√≥digo existente</li>
            <li style="margin-bottom: var(--space-2);">‚úÖ <strong>F√≥rmula matem√°tica correcta</strong> - No loops, usa Math.pow()</li>
            <li style="margin-bottom: var(--space-2);">‚úÖ <strong>Validaci√≥n robusta</strong> - Maneja todos los casos edge</li>
            <li>‚úÖ <strong>Documentaci√≥n JSDoc</strong> - Self-documenting code</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Testing Section -->
    <section class="section">
      <div style="text-align: center; margin-bottom: var(--space-8);">
        <h2 style="font-family: var(--font-primary); font-size: var(--text-3xl); font-weight: 700; margin-bottom: var(--space-4);">
          üß™ Testing: Prevenir Errores de $2.3M
        </h2>
        <p style="color: var(--text-secondary); font-size: var(--text-lg);">
          <strong>Kent C. Dodds' Testing Philosophy</strong>: Los tests que habr√≠an detectado el problema
        </p>
      </div>
      
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4); margin-bottom: var(--space-6);">
        <button id="runTestsBtn" class="btn btn-primary">
          üî¨ Ejecutar Todos los Tests
        </button>
        <button id="edgeTestsBtn" class="btn btn-secondary">
          ‚ö° Tests de Casos Edge
        </button>
      </div>
      
      <div id="testResults"></div>
    </section>

    <!-- Next Steps -->
    <section class="section">
      <div class="card" style="text-align: center; background: linear-gradient(135deg, var(--bg-secondary), var(--color-brand-light));">
        <h2 style="font-family: var(--font-primary); font-size: var(--text-3xl); font-weight: 700; margin-bottom: var(--space-4);">
          üöÄ Pr√≥ximos Pasos en tu Evoluci√≥n
        </h2>
        <p style="color: var(--text-secondary); font-size: var(--text-lg); margin-bottom: var(--space-8);">
          Has dominado los <strong>fundamentos de Clean Code</strong>. Ahora enfrenta errores m√°s sutiles y costosos.
        </p>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-4);">
          <a href="../precedencia-operadores/" class="btn btn-primary">
            üí• Precedencia de Operadores<br>
            <small style="opacity: 0.8;">$2.3M ‚Ä¢ Expert Level</small>
          </a>
          <a href="../operador-coma/" class="btn btn-primary">
            üî• Operador Coma<br>
            <small style="opacity: 0.8;">$500K ‚Ä¢ Intermediate</small>
          </a>
          <a href="../environment/" class="btn btn-secondary">
            üî¨ Laboratorio<br>
            <small style="opacity: 0.8;">Experimentaci√≥n Segura</small>
          </a>
        </div>
      </div>
    </section>

  </main>

  <!-- JavaScript Modules -->
  <script>
/* =============================================
 * CLEAN ARCHITECTURE - DOMAIN LAYER
 * Following Robert C. Martin's Clean Code principles
 * ============================================= */

// Pure Business Logic - No dependencies on UI or external systems
class CompoundInterestCalculator {
    /**
     * Calculate compound interest using the correct mathematical formula
     * A = P * (1 + r)^t
     * @param {number} principal - Initial capital
     * @param {number} annualRate - Annual rate (e.g., 5 for 5%)
     * @param {number} timeInYears - Time in years (accepts decimals)
     * @returns {number} Final amount
     */
    static calculate(principal, annualRate, timeInYears) {
        // Input validation (Kent Beck's Simple Design)
        if (!principal || principal <= 0) {
            throw new Error('Principal must be greater than 0');
        }
        if (annualRate < 0) {
            throw new Error('Rate cannot be negative');
        }
        if (timeInYears < 0) {
            throw new Error('Time cannot be negative');
        }
        
        // Correct mathematical formula
        const rate = annualRate / 100;
        return principal * Math.pow(1 + rate, timeInYears);
    }
    
    static calculateMonthlyCompounding(principal, annualRate, years) {
        const monthlyRate = annualRate / 100 / 12;
        const totalMonths = years * 12;
        return principal * Math.pow(1 + monthlyRate, totalMonths);
    }
}

// Naive method simulation (the one that broke FinTechCorp)
class NaiveCalculator {
    static calculate(principal, rate, years) {
        // Simulate the actual problems of the naive method
        if (rate !== 5) {
            throw new Error("NAIVE ERROR: Hardcoded for 5% only!");
        }
        
        const roundedYears = Math.round(years);
        if (Math.abs(years - roundedYears) > 0.01) {
            throw new Error(`NAIVE ERROR: Cannot handle ${years} years. Only integer years!`);
        }
        
        if (roundedYears > 20) {
            throw new Error("NAIVE ERROR: Code too long for more than 20 years!");
        }
        
        // Manual multiplication with precision loss
        let result = principal;
        for (let i = 0; i < roundedYears; i++) {
            result *= 1.05;
            result = Math.round(result * 100) / 100; // Precision loss simulation
        }
        
        return result;
    }
}

/* =============================================
 * APPLICATION LAYER - USE CASES
 * Orchestrates business logic and UI updates
 * ============================================= */

class FoundationCaseController {
    constructor(achievementTracker, uiManager) {
        this.achievementTracker = achievementTracker;
        this.ui = uiManager;
        this.metrics = {
            comparisons: 0,
            stressTests: 0,
            testsRun: 0,
            professionalMethodUsed: false,
            testingApplied: false
        };
    }
    
    compareCalculationMethods(principal, rate, time) {
        this.metrics.comparisons++;
        this.achievementTracker.updateProgress('experimentation', 
            Math.min(this.metrics.comparisons * 25, 75));
        
        let naiveResult = null;
        let naiveError = null;
        let professionalResult = null;
        let monthlyResult = null;
        
        // Try naive method (expect failures)
        try {
            naiveResult = NaiveCalculator.calculate(principal, rate, time);
        } catch (error) {
            naiveError = error.message;
        }
        
        // Professional method should always work
        try {
            professionalResult = CompoundInterestCalculator.calculate(principal, rate, time);
            monthlyResult = CompoundInterestCalculator.calculateMonthlyCompounding(principal, rate, time);
            this.metrics.professionalMethodUsed = true;
        } catch (error) {
            throw new Error(`Professional method failed: ${error.message}`);
        }
        
        // Performance comparison
        const performance = this.measurePerformance(principal, rate, time);
        
        // Update UI
        this.ui.showComparisonResults({
            naive: { result: naiveResult, error: naiveError },
            professional: professionalResult,
            monthly: monthlyResult,
            performance: performance,
            inputs: { principal, rate, time }
        });
        
        // Achievement triggers
        if (this.metrics.comparisons >= 3) {
            this.achievementTracker.trigger('foundation_experimentation_active', {
                costPrevented: 1000000,
                comparisons: this.metrics.comparisons
            });
        }
    }
    
    runStressTest() {
        this.metrics.stressTests++;
        
        const stressTests = [
            { principal: 1000000, rate: 12.5, time: 0.25, description: "High yield 3-month investment" },
            { principal: 50000, rate: 3.75, time: 25.7, description: "Long-term retirement planning" },
            { principal: 100, rate: 0.01, time: 100, description: "Ultra low rate, very long term" },
            { principal: 999999, rate: 99.99, time: 10, description: "Extreme values" }
        ];
        
        const results = stressTests.map(test => {
            try {
                const naive = NaiveCalculator.calculate(test.principal, test.rate, test.time);
                const professional = CompoundInterestCalculator.calculate(test.principal, test.rate, test.time);
                return { ...test, naive, professional, success: true };
            } catch (error) {
                const professional = CompoundInterestCalculator.calculate(test.principal, test.rate, test.time);
                return { ...test, professional, error: error.message, success: false };
            }
        });
        
        this.ui.showStressTestResults(results);
        
        this.achievementTracker.trigger('foundation_stress_testing', {
            costPrevented: 1500000,
            stressTestsRun: this.metrics.stressTests
        });
    }
    
    runTestSuite() {
        this.metrics.testsRun++;
        this.metrics.testingApplied = true;
        
        const tests = this.createTestSuite();
        const results = tests.map(test => ({
            ...test,
            passed: test.fn(),
            timestamp: Date.now()
        }));
        
        this.ui.showTestResults(results);
        
        this.achievementTracker.trigger('foundation_testing_applied', {
            costPrevented: 1800000,
            testsRun: tests.length,
            testsPassed: results.filter(r => r.passed).length
        });
    }
    
    createTestSuite() {
        return [
            {
                name: "Basic calculation: $1000 at 5% for 5 years",
                fn: () => {
                    const result = CompoundInterestCalculator.calculate(1000, 5, 5);
                    const expected = 1276.28;
                    return Math.abs(result - expected) < 0.01;
                }
            },
            {
                name: "Decimal time period: 2.5 years",
                fn: () => {
                    const result = CompoundInterestCalculator.calculate(1000, 5, 2.5);
                    return result > 1000 && result < 1500;
                }
            },
            {
                name: "Zero rate test",
                fn: () => {
                    const result = CompoundInterestCalculator.calculate(1000, 0, 5);
                    return Math.abs(result - 1000) < 0.01;
                }
            },
            {
                name: "Zero time test",
                fn: () => {
                    const result = CompoundInterestCalculator.calculate(1000, 5, 0);
                    return Math.abs(result - 1000) < 0.01;
                }
            },
            {
                name: "Validation: Negative principal",
                fn: () => {
                    try {
                        CompoundInterestCalculator.calculate(-1000, 5, 5);
                        return false;
                    } catch (error) {
                        return error.message.includes('Principal');
                    }
                }
            },
            {
                name: "Validation: Negative rate",
                fn: () => {
                    try {
                        CompoundInterestCalculator.calculate(1000, -5, 5);
                        return false;
                    } catch (error) {
                        return error.message.includes('Rate');
                    }
                }
            }
        ];
    }
    
    measurePerformance(principal, rate, time) {
        const iterations = 1000;
        
        // Naive performance (if it works)
        let naiveTime = 0;
        try {
            const start = performance.now();
            for (let i = 0; i < iterations; i++) {
                NaiveCalculator.calculate(principal, rate, time);
            }
            naiveTime = performance.now() - start;
        } catch (error) {
            naiveTime = -1; // Indicates failure
        }
        
        // Professional performance
        const start = performance.now();
        for (let i = 0; i < iterations; i++) {
            CompoundInterestCalculator.calculate(principal, rate, time);
        }
        const professionalTime = performance.now() - start;
        
        return {
            naive: naiveTime,
            professional: professionalTime,
            iterations: iterations
        };
    }
    
    checkFoundationMastery() {
        return (
            this.metrics.comparisons >= 3 &&
            this.metrics.testsRun >= 1 &&
            this.metrics.professionalMethodUsed &&
            this.metrics.testingApplied
        );
    }
}

/* =============================================
 * INFRASTRUCTURE LAYER - UI & EXTERNAL SYSTEMS
 * Handles all UI updates and external interactions
 * ============================================= */

class FoundationUIManager {
    constructor() {
        this.resultsPanel = document.getElementById('resultsPanel');
        this.testResults = document.getElementById('testResults');
    }
    
    showComparisonResults(data) {
        const { naive, professional, monthly, performance, inputs } = data;
        
        let naiveDisplay = '';
        if (naive.error) {
            naiveDisplay = `
                <div class="result-panel danger">
                    <h4 style="font-family: var(--font-primary); margin-bottom: var(--space-3);">üî• M√©todo Naive</h4>
                    <div style="color: var(--color-danger); font-weight: 600; margin-bottom: var(--space-2);">
                        ‚ùå FAILED
                    </div>
                    <div style="color: var(--text-secondary); font-size: var(--text-sm);">
                        ${naive.error}
                    </div>
                    <div style="margin-top: var(--space-3); font-size: var(--text-xs); color: var(--text-muted);">
                        ‚ö†Ô∏è This is exactly what broke FinTechCorp
                    </div>
                </div>
            `;
        } else {
            const difference = Math.abs(professional - naive.result);
            const percentDiff = (difference / professional) * 100;
            
            naiveDisplay = `
                <div class="result-panel ${percentDiff > 1 ? 'danger' : 'success'}">
                    <h4 style="font-family: var(--font-primary); margin-bottom: var(--space-3);">üî• M√©todo Naive</h4>
                    <div class="result-value" style="color: ${percentDiff > 1 ? 'var(--color-danger)' : 'var(--color-success)'};">
                        $${naive.result.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}
                    </div>
                    <div style="font-size: var(--text-sm); color: var(--text-secondary); margin-top: var(--space-2);">
                        Performance: ${performance.naive.toFixed(2)}ms (1000 iterations)<br>
                        Difference: ${percentDiff.toFixed(4)}% ${percentDiff > 1 ? '‚ö†Ô∏è CRITICAL' : '‚úÖ Acceptable'}
                    </div>
                </div>
            `;
        }
        
        this.resultsPanel.innerHTML = `
            <div style="width: 100%;">
                <h3 style="font-family: var(--font-primary); margin-bottom: var(--space-6); text-align: center;">
                    üìä Comparison Results
                </h3>
                
                <div class="result-comparison">
                    ${naiveDisplay}
                    
                    <div class="result-panel success">
                        <h4 style="font-family: var(--font-primary); margin-bottom: var(--space-3);">‚úÖ Professional Method</h4>
                        <div class="result-value" style="color: var(--color-success);">
                            $${professional.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}
                        </div>
                        <div style="font-size: var(--text-sm); color: var(--text-secondary); margin-top: var(--space-2);">
                            Performance: ${performance.professional.toFixed(2)}ms (1000 iterations)<br>
                            Precision: ‚úÖ Mathematically exact<br>
                            Flexibility: ‚úÖ Any value works
                        </div>
                    </div>
                </div>
                
                <div style="background: var(--bg-surface); padding: var(--space-4); border-radius: var(--radius-lg); margin-top: var(--space-6); border: 1px solid var(--border-color);">
                    <h4 style="font-family: var(--font-primary); color: var(--color-brand); margin-bottom: var(--space-3);">
                        üìà Analysis Summary
                    </h4>
                    <div style="color: var(--text-secondary); font-size: var(--text-sm);">
                        <strong>Input:</strong> $${inputs.principal.toLocaleString()} at ${inputs.rate}% for ${inputs.time} years<br>
                        <strong>Monthly compounding:</strong> $${monthly.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}<br>
                        <strong>Key insight:</strong> ${naive.error ? 
                            'The naive method failed with these parameters because it was designed for one specific case (5% annual, integer years). The professional method works for ANY scenario.' :
                            'Both methods work for this case, but try changing the rate to 7% or time to 2.5 years to see how the naive method fails.'
                        }
                    </div>
                </div>
            </div>
        `;
    }
    
    showStressTestResults(results) {
        let html = `
            <div style="width: 100%;">
                <h3 style="font-family: var(--font-primary); margin-bottom: var(--space-6); text-align: center;">
                    üî• Stress Test Results
                </h3>
        `;
        
        results.forEach((test, index) => {
            if (test.success) {
                const difference = Math.abs(test.professional - test.naive);
                const percentDiff = (difference / test.professional) * 100;
                
                html += `
                    <div class="card" style="margin-bottom: var(--space-4);">
                        <h5 style="color: var(--color-brand); margin-bottom: var(--space-2);">Test ${index + 1}: ${test.description}</h5>
                        <div style="font-size: var(--text-sm); color: var(--text-secondary);">
                            Capital: $${test.principal.toLocaleString()} | Rate: ${test.rate}% | Time: ${test.time} years<br>
                            Naive: $${test.naive.toLocaleString('en-US', {maximumFractionDigits: 2})} | 
                            Professional: $${test.professional.toLocaleString('en-US', {maximumFractionDigits: 2})}<br>
                            <span style="color: ${percentDiff > 1 ? 'var(--color-danger)' : 'var(--color-success)'};">
                                Difference: ${percentDiff.toFixed(4)}% ${percentDiff > 1 ? '‚ö†Ô∏è CRITICAL' : '‚úÖ Acceptable'}
                            </span>
                        </div>
                    </div>
                `;
            } else {
                html += `
                    <div class="card" style="margin-bottom: var(--space-4); border-color: var(--color-danger);">
                        <h5 style="color: var(--color-danger); margin-bottom: var(--space-2);">Test ${index + 1}: ERROR</h5>
                        <div style="font-size: var(--text-sm); color: var(--color-danger);">${test.error}</div>
                        <div style="font-size: var(--text-sm); color: var(--text-secondary); margin-top: var(--space-2);">
                            Professional result: $${test.professional.toLocaleString('en-US', {maximumFractionDigits: 2})}
                        </div>
                    </div>
                `;
            }
        });
        
        html += '</div>';
        this.resultsPanel.innerHTML = html;
    }
    
    showTestResults(results) {
        const passedCount = results.filter(r => r.passed).length;
        const totalCount = results.length;
        
        let html = `
            <div style="background: var(--bg-surface); padding: var(--space-6); border-radius: var(--radius-xl); border: 1px solid var(--border-color); margin-bottom: var(--space-6);">
                <h4 style="font-family: var(--font-primary); color: var(--color-success); margin-bottom: var(--space-3);">
                    üß™ Test Suite Results
                </h4>
                <div style="color: var(--text-secondary);">
                    <strong>${passedCount}/${totalCount} tests passed</strong><br>
                    ${passedCount === totalCount ? 
                      '‚úÖ Professional code approved! This code would have saved FinTechCorp.' :
                      '‚ö†Ô∏è Some tests failed. Code needs more work.'
                    }
                </div>
            </div>
            
            <div style="display: grid; gap: var(--space-3);">
        `;
        
        results.forEach(test => {
            html += `
                <div class="card" style="border-color: ${test.passed ? 'var(--color-success)' : 'var(--color-danger)'}; background: ${test.passed ? 'var(--color-success-light)' : 'var(--color-danger-light)'};">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="font-family: var(--font-primary); font-weight: 600;">${test.name}</div>
                        <div class="badge badge-${test.passed ? 'success' : 'danger'}">
                            ${test.passed ? '‚úÖ PASS' : '‚ùå FAIL'}
                        </div>
                    </div>
                </div>
            `;
        });
        
        html += '</div>';
        this.testResults.innerHTML = html;
    }
}

// Achievement System Integration
class FoundationAchievementTracker {
    constructor() {
        this.startTime = Date.now();
        this.progress = {
            problem: 0,
            experimentation: 0,
            mastery: 0
        };
        
        this.showProgressSidebar();
        this.trigger('foundation_case_started', { costPrevented: 0 });
    }
    
    updateProgress(category, percentage, message = '') {
        this.progress[category] = Math.min(percentage, 100);
        
        if (category === 'problem') {
            this.updateProgressRing('problemProgressRing', 'problemPercentage', percentage);
        } else if (category === 'experimentation') {
            this.updateExperimentationBadge(percentage);
        } else if (category === 'mastery') {
            this.updateMasteryBadge(percentage);
        }
        
        this.checkMasteryAchievement();
    }
    
    updateProgressRing(ringId, textId, percentage) {
        const ring = document.getElementById(ringId);
        const text = document.getElementById(textId);
        
        if (ring && text) {
            const circumference = 2 * Math.PI * 54;
            const offset = circumference - (percentage / 100) * circumference;
            
            ring.style.strokeDashoffset = offset;
            text.textContent = Math.round(percentage) + '%';
        }
    }
    
    updateExperimentationBadge(percentage) {
        const badge = document.getElementById('experimentationBadge');
        const count = document.getElementById('experimentationCount');
        
        if (badge && count) {
            const experimentCount = Math.floor(percentage / 25);
            count.textContent = experimentCount;
            badge.style.opacity = percentage > 0 ? '1' : '0.3';
        }
    }
    
    updateMasteryBadge(percentage) {
        const badge = document.getElementById('masteryBadge');
        if (badge) {
            badge.style.opacity = percentage >= 50 ? '1' : '0.3';
        }
    }
    
    showProgressSidebar() {
        const sidebar = document.getElementById('progressSidebar');
        if (sidebar) {
            setTimeout(() => {
                sidebar.classList.add('visible');
                this.updateProgress('problem', 10, 'Foundation learning started');
            }, 1000);
        }
    }
    
    checkMasteryAchievement() {
        const totalProgress = (this.progress.problem + this.progress.experimentation + this.progress.mastery) / 3;
        
        if (totalProgress >= 80) {
            this.showMasteryAchievement();
        }
    }
    
    showMasteryAchievement() {
        const masteryElement = document.getElementById('masteryAchieved');
        if (masteryElement && masteryElement.style.opacity === '0') {
            masteryElement.style.opacity = '1';
            masteryElement.style.transform = 'scale(1)';
            
            this.trigger('foundation_mastery_achieved', {
                costPrevented: 2300000,
                totalProgress: this.progress
            });
        }
    }
    
    trigger(eventType, data = {}) {
        const achievementData = {
            userId: this.getUserId(),
            completionTime: Date.now() - this.startTime,
            caseType: 'calculadora_interes',
            difficultyLevel: 'foundation',
            timestamp: Date.now(),
            ...data
        };
        
        // Show achievement toast
        this.showAchievementToast(eventType, data);
        
        // Integration with main achievement system
        if (window.coreAPI && typeof window.coreAPI.triggerCaseCompletion === 'function') {
            try {
                window.coreAPI.triggerCaseCompletion(eventType, achievementData);
            } catch (error) {
                console.warn('Achievement system error:', error);
                this.fallbackStorage(eventType, achievementData);
            }
        } else {
            this.fallbackStorage(eventType, achievementData);
        }
        
        console.log('üèÜ Foundation achievement:', eventType, achievementData);
    }
    
    showAchievementToast(eventType, data) {
        const toast = document.getElementById('achievementToast');
        const icon = document.getElementById('achievementIcon');
        const text = document.getElementById('achievementText');
        
        const messages = {
            'foundation_case_started': { icon: 'üéØ', text: 'Foundation Learning Started!' },
            'foundation_experimentation_active': { icon: 'üß™', text: 'Active Learning Unlocked!' },
            'foundation_testing_applied': { icon: 'üî¨', text: 'Testing Master!' },
            'foundation_mastery_achieved': { icon: 'üèÜ', text: 'Foundation Mastery Achieved!' }
        };
        
        const message = messages[eventType] || { icon: '‚úÖ', text: 'Achievement Unlocked!' };
        
        if (toast && icon && text) {
            icon.textContent = message.icon;
            text.textContent = message.text;
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
    }
    
    fallbackStorage(eventType, data) {
        const completions = JSON.parse(localStorage.getItem('foundation-case-progress') || '{}');
        completions[eventType] = data;
        localStorage.setItem('foundation-case-progress', JSON.stringify(completions));
    }
    
    getUserId() {
        let userId = localStorage.getItem('bugs-millones-user-id');
        if (!userId) {
            userId = 'user-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('bugs-millones-user-id', userId);
        }
        return userId;
    }
}

/* =============================================
 * APPLICATION INITIALIZATION
 * Dependency injection and event binding
 * ============================================= */

class FoundationCaseApp {
    constructor() {
        this.achievementTracker = new FoundationAchievementTracker();
        this.uiManager = new FoundationUIManager();
        this.controller = new FoundationCaseController(this.achievementTracker, this.uiManager);
        
        this.initializeEventListeners();
        this.runInitialComparison();
    }
    
    initializeEventListeners() {
        // Input change handlers
        const inputs = ['principalInput', 'rateInput', 'timeInput'];
        inputs.forEach(id => {
            const input = document.getElementById(id);
            if (input) {
                input.addEventListener('input', this.debounce(() => {
                    this.controller.compareCalculationMethods(
                        parseFloat(document.getElementById('principalInput').value) || 1000,
                        parseFloat(document.getElementById('rateInput').value) || 5,
                        parseFloat(document.getElementById('timeInput').value) || 5
                    );
                }, 500));
            }
        });
        
        // Button handlers
        const compareBtn = document.getElementById('compareBtn');
        if (compareBtn) {
            compareBtn.addEventListener('click', () => {
                this.controller.compareCalculationMethods(
                    parseFloat(document.getElementById('principalInput').value) || 1000,
                    parseFloat(document.getElementById('rateInput').value) || 5,
                    parseFloat(document.getElementById('timeInput').value) || 5
                );
            });
        }
        
        const stressTestBtn = document.getElementById('stressTestBtn');
        if (stressTestBtn) {
            stressTestBtn.addEventListener('click', () => {
                this.controller.runStressTest();
            });
        }
        
        const runTestsBtn = document.getElementById('runTestsBtn');
        if (runTestsBtn) {
            runTestsBtn.addEventListener('click', () => {
                this.controller.runTestSuite();
            });
        }
        
        const edgeTestsBtn = document.getElementById('edgeTestsBtn');
        if (edgeTestsBtn) {
            edgeTestsBtn.addEventListener('click', () => {
                this.controller.runEdgeCaseTests();
            });
        }
    }
    
    runInitialComparison() {
        setTimeout(() => {
            this.controller.compareCalculationMethods(1000, 5, 5);
            this.achievementTracker.updateProgress('problem', 25, 'Initial comparison completed');
        }, 1000);
    }
    
    // Utility method for debouncing
    debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }
}

// Initialize application when DOM is ready
document.addEventListener('DOMContentLoaded', () => {
    const app = new FoundationCaseApp();
    
    // Make available globally for debugging
    window.foundationApp = app;
    
    console.log('üéØ Foundation case initialized with Clean Architecture');
    console.log('üí° Learn how professional practices prevent $2.3M disasters');
    console.log('üèÜ Achievement tracking: Foundation-level clean code mastery');
});
  </script>
</body>
</html>